\hypertarget{core_8h}{}\section{include/core.h File Reference}
\label{core_8h}\index{include/core.\+h@{include/core.\+h}}


The head of the core part of the module.  


{\ttfamily \#include \char`\"{}common.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ioctlcmd.\+h\char`\"{}}\newline
{\ttfamily \#include $<$asm/current.\+h$>$}\newline
{\ttfamily \#include $<$asm/ptrace.\+h$>$}\newline
{\ttfamily \#include $<$linux/fs.\+h$>$}\newline
{\ttfamily \#include $<$linux/hashtable.\+h$>$}\newline
{\ttfamily \#include $<$linux/ioctl.\+h$>$}\newline
{\ttfamily \#include $<$linux/kernel.\+h$>$}\newline
{\ttfamily \#include $<$linux/list.\+h$>$}\newline
{\ttfamily \#include $<$linux/module.\+h$>$}\newline
{\ttfamily \#include $<$linux/sched/task\+\_\+stack.\+h$>$}\newline
{\ttfamily \#include $<$linux/semaphore.\+h$>$}\newline
{\ttfamily \#include $<$linux/slab.\+h$>$}\newline
{\ttfamily \#include $<$linux/uaccess.\+h$>$}\newline
Include dependency graph for core.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{core_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=301pt]{core_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structfibered__process}{fibered\+\_\+process}}
\begin{DoxyCompactList}\small\item\em A node of the list of processes in \mbox{\hyperlink{structfibered__processes__list}{fibered\+\_\+processes\+\_\+list}}, a {\bfseries fiber-\/enabled} process. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structfibered__processes__list}{fibered\+\_\+processes\+\_\+list}}
\begin{DoxyCompactList}\small\item\em The list of processes that have at least one fiber. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structfiber}{fiber}}
\begin{DoxyCompactList}\small\item\em A node in the \mbox{\hyperlink{structfibers__list}{fibers\+\_\+list}}. This type fully represent a {\ttfamily fiber}. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structfibers__list}{fibers\+\_\+list}}
\begin{DoxyCompactList}\small\item\em A generic list of fibers. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{core_8h_a88633244fc905d1234bac90e464791da}\label{core_8h_a88633244fc905d1234bac90e464791da}} 
\#define {\bfseries E\+R\+R\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+A\+L\+R\+E\+A\+D\+Y\+\_\+\+F\+I\+B\+ER}~100
\item 
\mbox{\Hypertarget{core_8h_a4cc9121f26b7a012965835e97dfd5315}\label{core_8h_a4cc9121f26b7a012965835e97dfd5315}} 
\#define {\bfseries C\+O\+R\+E\+\_\+\+L\+OG}~\char`\"{}\+: D\+E\+V\+: \char`\"{}
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \mbox{\hyperlink{structfibered__process}{fibered\+\_\+process}} \mbox{\hyperlink{core_8h_aa16708c717e33e5e95614cd1e4ca7b2b}{fibered\+\_\+process\+\_\+node\+\_\+t}}
\begin{DoxyCompactList}\small\item\em A node of the list of processes in \mbox{\hyperlink{structfibered__processes__list}{fibered\+\_\+processes\+\_\+list}}, a {\bfseries fiber-\/enabled} process. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{core_8h_a87e2a324967b7142f288286f66f2a149}\label{core_8h_a87e2a324967b7142f288286f66f2a149}} 
typedef struct fiber\+\_\+processes\+\_\+list {\bfseries fiber\+\_\+process\+\_\+list\+\_\+t}
\item 
typedef struct \mbox{\hyperlink{structfiber}{fiber}} \mbox{\hyperlink{core_8h_adb14c8b48a1d56cf9c6632295ab90048}{fiber\+\_\+node\+\_\+t}}
\begin{DoxyCompactList}\small\item\em A node in the \mbox{\hyperlink{structfibers__list}{fibers\+\_\+list}}. This type fully represent a {\ttfamily fiber}. \end{DoxyCompactList}\item 
typedef struct \mbox{\hyperlink{structfibers__list}{fibers\+\_\+list}} \mbox{\hyperlink{core_8h_aad42420053a7ace7b3fb17805d6e9004}{fibers\+\_\+list\+\_\+t}}
\begin{DoxyCompactList}\small\item\em A generic list of fibers. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{core_8h_a707fd6f68415e6978adb340746527715}\label{core_8h_a707fd6f68415e6978adb340746527715}} 
typedef enum \mbox{\hyperlink{core_8h_a7b11bd960a2de8da146a5ebb7f7abbc2}{fiber\+\_\+state}} \mbox{\hyperlink{core_8h_a707fd6f68415e6978adb340746527715}{fiber\+\_\+state\+\_\+t}}
\begin{DoxyCompactList}\small\item\em The state of the fiber. \end{DoxyCompactList}\item 
typedef struct \mbox{\hyperlink{structfibered__processes__list}{fibered\+\_\+processes\+\_\+list}} \mbox{\hyperlink{core_8h_afffa2dfe134b8b5494026f1038f68a39}{fibered\+\_\+processes\+\_\+list\+\_\+t}}
\begin{DoxyCompactList}\small\item\em The list of processes that have at least one fiber. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{core_8h_a7b11bd960a2de8da146a5ebb7f7abbc2}{fiber\+\_\+state}} \{ \mbox{\hyperlink{core_8h_a7b11bd960a2de8da146a5ebb7f7abbc2a1061be6c3fb88d32829cba6f6b2be304}{R\+U\+N\+N\+I\+NG}}, 
\mbox{\hyperlink{core_8h_a7b11bd960a2de8da146a5ebb7f7abbc2afd6a0e4343048b10646dd2976cc5ad18}{I\+D\+LE}}
 \}
\begin{DoxyCompactList}\small\item\em The state of the fiber. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{core_8h_a62235692d124309201f915bec1a89374}{convert\+\_\+thread\+\_\+to\+\_\+fiber}} (void)
\begin{DoxyCompactList}\small\item\em Convert the current thread to a fiber. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
The head of the core part of the module. 

This file contains all the data structures and the methods that implements the core functions of the fiber module

\begin{DoxyAuthor}{Author}
Gabriele Proietti Mattia \href{mailto:gabry.gabry@hotmail.it}{\tt gabry.\+gabry@hotmail.\+it} 

Alexandru Daniel Tufa \href{mailto:alex.tufa94@gmail.com}{\tt alex.\+tufa94@gmail.\+com} 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2018-\/05-\/13 
\end{DoxyDate}


\subsection{Typedef Documentation}
\mbox{\Hypertarget{core_8h_adb14c8b48a1d56cf9c6632295ab90048}\label{core_8h_adb14c8b48a1d56cf9c6632295ab90048}} 
\index{core.\+h@{core.\+h}!fiber\+\_\+node\+\_\+t@{fiber\+\_\+node\+\_\+t}}
\index{fiber\+\_\+node\+\_\+t@{fiber\+\_\+node\+\_\+t}!core.\+h@{core.\+h}}
\subsubsection{\texorpdfstring{fiber\+\_\+node\+\_\+t}{fiber\_node\_t}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{structfiber}{fiber}} \mbox{\hyperlink{core_8h_adb14c8b48a1d56cf9c6632295ab90048}{fiber\+\_\+node\+\_\+t}}}



A node in the \mbox{\hyperlink{structfibers__list}{fibers\+\_\+list}}. This type fully represent a {\ttfamily fiber}. 

This is the complete description of a fiber. \mbox{\Hypertarget{core_8h_aa16708c717e33e5e95614cd1e4ca7b2b}\label{core_8h_aa16708c717e33e5e95614cd1e4ca7b2b}} 
\index{core.\+h@{core.\+h}!fibered\+\_\+process\+\_\+node\+\_\+t@{fibered\+\_\+process\+\_\+node\+\_\+t}}
\index{fibered\+\_\+process\+\_\+node\+\_\+t@{fibered\+\_\+process\+\_\+node\+\_\+t}!core.\+h@{core.\+h}}
\subsubsection{\texorpdfstring{fibered\+\_\+process\+\_\+node\+\_\+t}{fibered\_process\_node\_t}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{structfibered__process}{fibered\+\_\+process}} \mbox{\hyperlink{core_8h_aa16708c717e33e5e95614cd1e4ca7b2b}{fibered\+\_\+process\+\_\+node\+\_\+t}}}



A node of the list of processes in \mbox{\hyperlink{structfibered__processes__list}{fibered\+\_\+processes\+\_\+list}}, a {\bfseries fiber-\/enabled} process. 

A \mbox{\hyperlink{structfibered__process}{fibered\+\_\+process}} is a process in which at least one thread has been converted to a fiber, so a \mbox{\hyperlink{structfibered__process}{fibered\+\_\+process}} always has at least one fiber in the \mbox{\hyperlink{structfibered__process_a1aae0be425bbc05b6444909f16ec56b9}{fibered\+\_\+process\+::fibers\+\_\+list}} field. Moreover the first element of the list has \mbox{\hyperlink{structfibered__process_adf5ba8614f416e75bc026fe449fdd08c}{fibered\+\_\+process\+::prev}} pointing to {\ttfamily N\+U\+LL} and the last element of the list has \mbox{\hyperlink{structfibered__process_a8779fb1384900987ccd2d0d9de09a1ab}{fibered\+\_\+process\+::next}} pointing to {\ttfamily N\+U\+LL}. \mbox{\Hypertarget{core_8h_afffa2dfe134b8b5494026f1038f68a39}\label{core_8h_afffa2dfe134b8b5494026f1038f68a39}} 
\index{core.\+h@{core.\+h}!fibered\+\_\+processes\+\_\+list\+\_\+t@{fibered\+\_\+processes\+\_\+list\+\_\+t}}
\index{fibered\+\_\+processes\+\_\+list\+\_\+t@{fibered\+\_\+processes\+\_\+list\+\_\+t}!core.\+h@{core.\+h}}
\subsubsection{\texorpdfstring{fibered\+\_\+processes\+\_\+list\+\_\+t}{fibered\_processes\_list\_t}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{structfibered__processes__list}{fibered\+\_\+processes\+\_\+list}}  \mbox{\hyperlink{core_8h_afffa2dfe134b8b5494026f1038f68a39}{fibered\+\_\+processes\+\_\+list\+\_\+t}}}



The list of processes that have at least one fiber. 

This list has the purpose of containing the list of processes that have created at least one fiber and they became fiber-\/enabled. The list can be considered empty when at least one of \mbox{\hyperlink{structfibered__processes__list_a460c3f34099c7589c25c383add98650b}{fibered\+\_\+processes\+\_\+list\+::head}} or \mbox{\hyperlink{structfibered__processes__list_a423b95d461fa440ede7dd019b8c94aa6}{fibered\+\_\+processes\+\_\+list\+::tail}} is pointing to {\ttfamily N\+U\+LL}. \mbox{\Hypertarget{core_8h_aad42420053a7ace7b3fb17805d6e9004}\label{core_8h_aad42420053a7ace7b3fb17805d6e9004}} 
\index{core.\+h@{core.\+h}!fibers\+\_\+list\+\_\+t@{fibers\+\_\+list\+\_\+t}}
\index{fibers\+\_\+list\+\_\+t@{fibers\+\_\+list\+\_\+t}!core.\+h@{core.\+h}}
\subsubsection{\texorpdfstring{fibers\+\_\+list\+\_\+t}{fibers\_list\_t}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{structfibers__list}{fibers\+\_\+list}} \mbox{\hyperlink{core_8h_aad42420053a7ace7b3fb17805d6e9004}{fibers\+\_\+list\+\_\+t}}}



A generic list of fibers. 

The list has the purpose of containing the list of fibers for a given process. The list can be considered empty when at least one of \mbox{\hyperlink{structfibers__list_aa1dd39c8c192607d164f204821d5b3ed}{fibers\+\_\+list\+::head}} or \mbox{\hyperlink{structfibers__list_af94c6bcedeb27c078ea1fa4869c53673}{fibers\+\_\+list\+::tail}} is pointing to {\ttfamily N\+U\+LL}. 

\subsection{Enumeration Type Documentation}
\mbox{\Hypertarget{core_8h_a7b11bd960a2de8da146a5ebb7f7abbc2}\label{core_8h_a7b11bd960a2de8da146a5ebb7f7abbc2}} 
\index{core.\+h@{core.\+h}!fiber\+\_\+state@{fiber\+\_\+state}}
\index{fiber\+\_\+state@{fiber\+\_\+state}!core.\+h@{core.\+h}}
\subsubsection{\texorpdfstring{fiber\+\_\+state}{fiber\_state}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{core_8h_a7b11bd960a2de8da146a5ebb7f7abbc2}{fiber\+\_\+state}}}



The state of the fiber. 

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{R\+U\+N\+N\+I\+NG@{R\+U\+N\+N\+I\+NG}!core.\+h@{core.\+h}}\index{core.\+h@{core.\+h}!R\+U\+N\+N\+I\+NG@{R\+U\+N\+N\+I\+NG}}}\mbox{\Hypertarget{core_8h_a7b11bd960a2de8da146a5ebb7f7abbc2a1061be6c3fb88d32829cba6f6b2be304}\label{core_8h_a7b11bd960a2de8da146a5ebb7f7abbc2a1061be6c3fb88d32829cba6f6b2be304}} 
R\+U\+N\+N\+I\+NG&The fiber is running since the thread switched to it \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{I\+D\+LE@{I\+D\+LE}!core.\+h@{core.\+h}}\index{core.\+h@{core.\+h}!I\+D\+LE@{I\+D\+LE}}}\mbox{\Hypertarget{core_8h_a7b11bd960a2de8da146a5ebb7f7abbc2afd6a0e4343048b10646dd2976cc5ad18}\label{core_8h_a7b11bd960a2de8da146a5ebb7f7abbc2afd6a0e4343048b10646dd2976cc5ad18}} 
I\+D\+LE&The fiber is created but no thread switched to it \\
\hline

\end{DoxyEnumFields}


\subsection{Function Documentation}
\mbox{\Hypertarget{core_8h_a62235692d124309201f915bec1a89374}\label{core_8h_a62235692d124309201f915bec1a89374}} 
\index{core.\+h@{core.\+h}!convert\+\_\+thread\+\_\+to\+\_\+fiber@{convert\+\_\+thread\+\_\+to\+\_\+fiber}}
\index{convert\+\_\+thread\+\_\+to\+\_\+fiber@{convert\+\_\+thread\+\_\+to\+\_\+fiber}!core.\+h@{core.\+h}}
\subsubsection{\texorpdfstring{convert\+\_\+thread\+\_\+to\+\_\+fiber()}{convert\_thread\_to\_fiber()}}
{\footnotesize\ttfamily int convert\+\_\+thread\+\_\+to\+\_\+fiber (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Convert the current thread to a fiber. 

\subsection*{Implementation}

When a thread is converted to a fiber several task are performed. First of all, if the process never created a fiber, it must become {\bfseries fiber-\/enabled}, this means that we have to instantiate a \mbox{\hyperlink{structfibered__process}{fibered\+\_\+process}} element in the \mbox{\hyperlink{structfibered__processes__list}{fibered\+\_\+processes\+\_\+list}} variable. Then we have to instantiate a \mbox{\hyperlink{structfiber}{fiber}} element in the \mbox{\hyperlink{structfibers__list}{fibers\+\_\+list}} field of the \mbox{\hyperlink{structfibered__process}{fibered\+\_\+process}} element of the list.

\begin{DoxyReturn}{Returns}
int 0 if everything ok, otherwise an error listed in \mbox{\hyperlink{ioctlcmd_8h}{ioctlcmd.\+h}} 
\end{DoxyReturn}
